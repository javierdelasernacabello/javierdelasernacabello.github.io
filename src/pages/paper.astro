---
const heroUrl = "/cracked.jpeg";
---

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Portfolio 2026</title>
    <style>
      :root{
        --bg:#0b0f19;
        --text:#0b0f19;
        --paper:#ffffff;
      }
      *{ box-sizing:border-box; }
      body{ margin:0; background:var(--bg); font-family: Arial, Helvetica, sans-serif; }
      main{ min-height:100vh; }

      /* Scroll stage */
      .stage-wrap{
        position: relative;
        height: 2000vh; /* end scroll close to last mural image */
        background: var(--bg);
      }
      .stage{
        position: sticky;
        top: 0;
        height: 100vh;
        overflow: hidden;
        background: var(--bg);
      }

      .frame{
        position: absolute;
        inset: 0;
        display: grid;
        grid-template-columns: 1fr var(--strip-w, 0px);
        gap: 0;
        align-items: stretch;
        overflow: visible;
      }

      .hero{
        position: relative;
        overflow: hidden;
        background: #ffffff;
      }
      .hero-img{
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        transform: translateZ(0) scale(1);
        transform-origin: center center;
        will-change: transform, opacity;
      }

      .strip{
        background: var(--paper);
        display: flex;
        align-items: flex-start;
        justify-content: flex-start;
        overflow: visible;
        opacity: 1;
        transition: opacity 120ms linear;
      }
      .strip-text{
        color: var(--text);
        font-weight: 400;
        font-size: clamp(60px, 55vw, 200px);
        line-height: 0.78;
        letter-spacing: 0.01em;
        text-align: left;
        display: flex;
        flex-direction: column;
        gap: 0;
        transform: scaleX(0.94);
        transform-origin: left top;
        width: 100%;
        padding: 8px 16px 0 0;
        margin-left: -0.08em;
      }

      .name{
        position: absolute;
        inset: 0;
        display: block;
        opacity: 0;
        pointer-events: none;
      }
      .name-text{
        color: #000;
        font-weight: 500;
        font-size: clamp(90px, 20vw, 190px);
        line-height: 0.70;
        text-align: left;
        background: rgba(255,255,255,0.0);
        padding: 8px 0 0 8px;
        transform: scaleX(0.96);
        transform-origin: left top;
      }

      .mural-wrap{
        position: absolute;
        inset: 0;
        background: #fff;
        z-index: 3;
        opacity: 0;
        pointer-events: none;
        overflow: hidden;
      }
      #mural{
        display: flex;
        height: 100vh;
        width: max-content;
        transform: translateX(0);
        will-change: transform;
      }
      #mural img{
        height: 100vh;
        width: auto;
        display: block;
        flex-shrink: 0;
      }

      @media (max-width: 700px){
        .frame{ grid-template-columns: 1fr 32vw; }
        .strip-text{ font-size: clamp(44px, 14vw, 120px); }
      }
    </style>
  </head>
  <body>
    <main>
      <section class="stage-wrap" id="stageWrap">
        <div class="stage" id="stage">
          <div class="frame">
            <div class="hero">
              <img class="hero-img" id="heroImg" src={heroUrl} alt="" />
            </div>
            <div class="strip" id="strip">
              <div class="strip-text" id="stripText">
                <div>PO</div>
                <div>RF</div>
                <div>OL</div>
                <div>IO</div>
                <div>20</div>
                <div>26</div>
              </div>
            </div>
          </div>

          <div class="name" id="name">
            <div class="name-text">
              Javier<br />de<br />la<br />Serna
            </div>
          </div>

          <div class="mural-wrap" id="muralWrap">
            <div id="mural">
              <img src="/images/img_1.jpg" alt="1" />
              <img src="/images/img_2.jpg" alt="2" />
              <img src="/images/img_3.jpg" alt="3" />
              <img src="/images/img_4.jpg" alt="4" />
              <img src="/images/img_5.jpg" alt="5" />
              <img src="/images/img_6.jpg" alt="6" />
              <img src="/images/img_7.jpg" alt="7" />
              <img src="/images/img_8.jpg" alt="8" />
              <img src="/images/img_9.jpg" alt="9" />
              <img src="/images/img_10.jpg" alt="10" />
              <img src="/images/img_11.jpg" alt="11" />
              <img src="/images/img_12.jpg" alt="12" />
              <img src="/images/img_13.jpg" alt="13" />
              <img src="/images/img_14.jpg" alt="14" />
              <img src="/images/img_15.jpg" alt="15" />
              <img src="/images/img_16.jpg" alt="16" />
              <img src="/images/img_17.jpg" alt="17" />
              <img src="/images/img_18.jpg" alt="18" />
              <img src="/images/img_19.jpg" alt="19" />
              <img src="/images/img_20.jpg" alt="20" />
              <img src="/images/img_21.jpg" alt="21" />
              <img src="/images/img_22.jpg" alt="22" />
              <img src="/images/img_23.jpg" alt="23" />
              <img src="/images/img_24.jpg" alt="24" />
              <img src="/images/img_25.jpg" alt="25" />
              <img src="/images/img_26.jpg" alt="26" />
              <img src="/images/img_27.jpg" alt="27" />
              <img src="/images/img_28.jpg" alt="28" />
              <img src="/images/img_29.jpg" alt="29" />
              <img src="/images/img_30.jpg" alt="30" />
              <img src="/images/img_31.jpg" alt="31" />
              <img src="/images/img_32.jpg" alt="32" />
              <img src="/images/img_33.jpg" alt="33" />
            </div>
          </div>

        </div>
      </section>

    </main>

    <script>
      const wrap = document.getElementById("stageWrap");
      const hero = document.getElementById("heroImg");
      const strip = document.getElementById("strip");
      const frame = document.querySelector(".frame");
      const name = document.getElementById("name");
      const muralWrap = document.getElementById("muralWrap");
      const mural = document.getElementById("mural");

      function clamp(x, a, b){ return Math.max(a, Math.min(b, x)); }

      function onScroll() {
        const rect = wrap.getBoundingClientRect();
        const vh = window.innerHeight;
        const total = rect.height - vh;
        const progress = clamp((0 - rect.top) / Math.max(1, total), 0, 1);

        // --- 1. PORTFOLIO 2026 (El Strip lateral) ---
        // Ahora desaparece un poco m√°s lento (entre 0% y 25% del scroll)
        const coverProgress = clamp(progress / 0.20, 0, 1);
        const stripFade = clamp(1 - coverProgress * 4, 0, 1);
        strip.style.opacity = stripFade.toFixed(3);
        
        const baseStrip = Math.min(window.innerWidth * 0.35, 320);
        const stripW = Math.max(0, baseStrip * stripFade);
        frame.style.setProperty("--strip-w", `${stripW.toFixed(2)}px`);

        // --- 2. ZOOM E IMAGEN (Desvanecimiento a blanco) ---
        // El zoom es constante durante casi todo el proceso
        const zoomFactor = 2.5;
        const scale = 1 + (coverProgress * zoomFactor);
        hero.style.transform = `scale(${scale.toFixed(4)})`;

        // La imagen empieza a volverse transparente a partir del 35% del scroll
        // y desaparece totalmente en el 65%.
        const imageOpacity = clamp(1 - (progress - 0.15) * 20, 0, 1);
        hero.style.opacity = imageOpacity.toFixed(3);

        // --- 3. NOMBRE (Javier de la Serna) ---
        // Aparece cuando el strip ya se ha ido un poco (0.2) 
        // y se va antes de que el About Me tome el control (0.5)
        const nameFadeIn = clamp((progress - 0.001) * 10, 0, 1);
        const nameFadeOut = clamp((progress - 0.16) * 10, 0, 1);
        name.style.opacity = (nameFadeIn * (1 - nameFadeOut)).toFixed(3);

        if (muralWrap && mural) {
          const muralFade = clamp((progress - 0.12) * 12, 0, 1);
          muralWrap.style.opacity = muralFade.toFixed(3);
          const muralMove = clamp((progress - 0.21) / 0.79, 0, 1);
          const maxShift = Math.max(0, mural.scrollWidth - window.innerWidth);
          mural.style.transform = `translateX(${-muralMove * maxShift}px)`;
        }
      }

      window.addEventListener("scroll", onScroll, { passive: true });
      window.addEventListener("resize", onScroll);
      onScroll();
    </script>
  </body>
</html>
